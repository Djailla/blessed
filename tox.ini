[tox]
envlist = py26,
          py27,
          py33,
          pypy


[testenv]
# for any python, run simple pytest
# with pep8 and pyflake checking
deps = pytest
       pytest-pep8
       pytest-flakes
       mock

commands = {envbindir}/coverage run \
           -p \
           {envbindir}/py.test \
           -x --strict --pep8 --flakes \
           blessed/tests \
           {posargs}


[testenv:py27]
# for python27, measure coverage
deps = coverage
       pytest
       pytest-pep8
       pytest-flakes
       pytest-cov
       mock

commands = {envbindir}/coverage run \
           -p \
           {envbindir}/py.test \
           -x --strict --pep8 --flakes \
           --cov blessed \
           blessed/tests \
           {posargs}


[testenv:py33]
# for python3, test the version of blessed *installed*,
# and not from source. This is because we use the 2to3 tool.
changedir = {toxworkdir}
commands = {envbindir}/coverage run \
           -p --rcfile=$TRAVIS_BUILD_DIR/.coveragerc \
           {envbindir}/py.test \
           -x --strict --pep8 --flakes \
           --cov {envsitepackagesdir}/blessed \
           {envsitepackagesdir}/blessed/tests \
           {posargs}
